<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.zll.dms.dao.TransmissionDetailDao">
	<resultMap id="TransmissionDetail" type="com.zll.dms.model.TransmissionDetail">
		<id column="id" property="id" /><!-- ID -->
		<result column="vehicle_id" property="vehicleId" /><!-- 车辆ID -->
		<result column="file_name" property="fileName" /><!-- 文件名称 -->
		<result column="last_update_time" property="lastUpdateTime" /><!-- 
			最后修改时间 -->
		<result column="file_size" property="fileSize" /><!-- 文件大小 -->
		<result column="file_path" property="filePath" /><!-- 文件路径 -->
		<result column="type" property="type" /><!-- 数据类型：arcos或者edr -->
		<association property="vehicle" column="vehicle_id"
			select="com.zll.dms.dao.VehicleDao.get" />
	</resultMap>

	<!-- 获取Transmission明细数据列表 -->
	<select id="getList" resultMap="TransmissionDetail"
		parameterType="map">
		select
		id,
		vehicle_id,
		file_name,
		last_update_time,
		file_size,
		file_path,
		type
		from transmission_detail
		where 1 = 1
		<if test="vehicleId != null">
			and vehicle_id = #{vehicleId}
		</if>
		<if test="fileName != null">
			and file_name = #{fileName}
		</if>
		<if test="type != null">
			and type = #{type}
		</if>
		order by last_update_time desc
	</select>

	<!-- 添加实时数据 mysql版本 <insert id="addList" parameterType="TransmissionDetail"> 
		insert into transmission_detail( id, vehicle_id, file_name, last_update_time, 
		file_size, file_path, type ) values <foreach collection="list" item="item" 
		index="index" separator=","> ( #{item.id}, #{item.vehicleId}, #{item.fileName}, 
		#{item.lastUpdateTime}, #{item.fileSize}, #{item.filePath}, #{item.type} 
		) </foreach> </insert> -->

	<!-- 添加实时数据 oracle版本 -->
	<insert id="addList" parameterType="list">
		insert into transmission_detail (id, vehicle_id, file_name,
		last_update_time, file_size, file_path, type)
		(
		<foreach collection="list" index="" item="item" separator="union all">
			select
			#{item.id},
			#{item.vehicleId},
			#{item.fileName},
			#{item.lastUpdateTime},
			#{item.fileSize},
			#{item.filePath},
			#{item.type}
			from dual
		</foreach>
		)
	</insert>
	<!-- 更新传输数据 -->
	<update id="update" parameterType="TransmissionDetail">
		update transmission_detail
		<set>
			<if test="vehicleId != null">
				vehicle_id = #{vehicleId},
			</if>
			<if test="fileName != null">
				file_name = #{fileName},
			</if>
			<if test="lastUpdateTime != null">
				last_update_time = #{lastUpdateTime},
			</if>
			<if test="fileSize != null">
				file_size = #{fileSize},
			</if>
			<if test="filePath != null">
				file_path = #{filePath},
			</if>
			<if test="type != null">
				type = #{type}
			</if>
		</set>
		where id = #{id}
	</update>
	<!-- 删除Transmission详细数据 -->
	<delete id="delete" parameterType="map">
		delete from transmission_detail
		where 1 = 1
		and id in
		<foreach collection="idSet" index="index" item="item" open="("
			separator="," close=")">
			#{item}
		</foreach>
	</delete>

</mapper>